import{a as g}from"./chunk-P5LOYQB2.js";import{B as o,W as a,aa as l,ea as c,g as i,n}from"./chunk-7GBT3Z6V.js";var r=class r{constructor(t){this.http=t;this.apiUrl="http://localhost:3000/api/auth";this.userSubject=new i(null);this.user$=this.userSubject.asObservable();let e=localStorage.getItem("user");e&&this.userSubject.next(JSON.parse(e))}handleError(t){let e="Ha ocurrido un error en el servidor";return t.error instanceof ErrorEvent?e="Error: "+t.error.message:t.status===401?e=t.error?.message||"Credenciales inv\xE1lidas":t.status===409?e=t.error?.message||"El correo ya est\xE1 registrado":t.status===404?e="El servicio no est\xE1 disponible":t.status===0&&(e="No se puede conectar con el servidor. Por favor, verifica tu conexi\xF3n."),n(()=>e)}login(t,e){return this.http.post(`${this.apiUrl}/login`,{email:t,password:e}).pipe(a(s=>{localStorage.setItem("token",s.access_token),localStorage.setItem("user",JSON.stringify(s.user)),this.userSubject.next(s.user)}),o(this.handleError))}register(t,e,s,u){return this.http.post(`${this.apiUrl}/register`,{nombre:t,apellido:e,email:s,password:u}).pipe(o(this.handleError))}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),this.userSubject.next(null)}getToken(){return localStorage.getItem("token")}isLoggedIn(){return!!this.getToken()}};r.\u0275fac=function(e){return new(e||r)(c(g))},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});var p=r;export{p as a};
