import{D as B,Pb as E}from"./chunk-HSKCSBWS.js";import{l as z}from"./chunk-KV5YFX3I.js";import{Ba as P,Fc as u,Hc as b,Qb as j,Rb as w,Tc as v,Wb as f,Xb as _,Yb as g,Zb as I,aa as T,cb as x,ib as y,qc as p,rb as S,xb as D}from"./chunk-7GBT3Z6V.js";var m=class m{constructor(){}processDataForTable(e){if(!e||e.length===0)return[];let t=new Map;e.forEach(a=>{let o=`${a.edificio_nombre}-${a.zona_nombre}-${a.nivel_nombre}`;t.has(o)||t.set(o,{edificio:a.edificio_nombre,zona:a.zona_nombre,nivel:a.nivel_nombre,voltajes:[],corrientes:[],potencias:[]});let s=t.get(o);s.voltajes.push(a.voltaje),s.corrientes.push(a.corriente),s.potencias.push(a.potencia_calc)});let r=[];return t.forEach(a=>{let o=a.voltajes.length>0?a.voltajes.reduce((l,i)=>l+i,0)/a.voltajes.length:0,s=a.corrientes.reduce((l,i)=>l+i,0),h=a.potencias.reduce((l,i)=>l+i,0);r.push({edificio:a.edificio,zona:a.zona,nivel:a.nivel,voltaje:Math.round(o*100)/100,corriente:Math.round(s*100)/100,potencia:Math.round(h*100)/100,registros:a.voltajes.length})}),r.sort((a,o)=>a.edificio!==o.edificio?a.edificio.localeCompare(o.edificio):a.zona!==o.zona?a.zona.localeCompare(o.zona):a.nivel.localeCompare(o.nivel))}getTableSummary(e){if(!e||e.length===0)return{totalRegistros:0,promedioVoltaje:0,totalCorriente:0,totalPotencia:0,edificiosUnicos:0,zonasUnicas:0,nivelesUnicos:0};let t=e.reduce((i,c)=>i+c.registros,0),r=e.reduce((i,c)=>i+c.voltaje,0)/e.length,a=e.reduce((i,c)=>i+c.corriente,0),o=e.reduce((i,c)=>i+c.potencia,0),s=new Set(e.map(i=>i.edificio)).size,h=new Set(e.map(i=>i.zona)).size,l=new Set(e.map(i=>i.nivel)).size;return{totalRegistros:t,promedioVoltaje:Math.round(r*100)/100,totalCorriente:Math.round(a*100)/100,totalPotencia:Math.round(o*100)/100,edificiosUnicos:s,zonasUnicas:h,nivelesUnicos:l}}};m.\u0275fac=function(t){return new(t||m)},m.\u0275prov=T({token:m,factory:m.\u0275fac,providedIn:"root"});var C=m;var k=()=>({column:"potencia",state:"desc"}),V=()=>({hover:!0,striped:!0,responsive:!0}),U=()=>({align:"middle"});function N(n,e){n&1&&(_(0,"div",2),I(1,"i",3),u(2,` Cargando datos de la tabla...
`),g())}function L(n,e){if(n&1&&u(0),n&2){let t=p().tdContent;b(" ",t," V ")}}function O(n,e){if(n&1&&u(0),n&2){let t=p().tdContent;b(" ",t," A ")}}function A(n,e){if(n&1&&u(0),n&2){let t=p().tdContent;b(" ",t," W ")}}function $(n,e){if(n&1&&u(0),n&2){let t=p().tdContent;b(" ",t," ")}}function W(n,e){if(n&1&&(_(0,"td"),j(1,L,1,1)(2,O,1,1)(3,A,1,1)(4,$,1,1),g()),n&2){let t,r=e.columnName;x(),w((t=r)==="voltaje"?1:t==="corriente"?2:t==="potencia"?3:4)}}function Z(n,e){if(n&1&&(_(0,"c-smart-table",4),D(1,W,5,1,"ng-template",5),g()),n&2){let t=p();f("activePage",1)("columnSorter",!0)("columns",t.columns)("columnFilter",!0)("itemsPerPageSelect",!0)("itemsPerPage",10)("items",t.tableData)("sorterValue",v(11,k))("tableFilter",!0)("tableProps",v(12,V))("tableBodyProps",v(13,U))}}var d=class d{constructor(e){this.tableDataService=e;this.apiData=[];this.isLoading=!1;this.tableData=[];this.columns=[{key:"edificio",label:"Edificio",_style:{width:"20%"}},{key:"zona",label:"Zona",_style:{width:"20%"}},{key:"nivel",label:"Nivel",_style:{width:"20%"}},{key:"voltaje",label:"Voltaje",_style:{width:"15%"}},{key:"corriente",label:"Corriente",_style:{width:"15%"}},{key:"potencia",label:"Potencia",_style:{width:"15%"}}];this.details_visible=Object.create({})}ngOnChanges(e){e.apiData&&this.apiData&&this.processTableData()}processTableData(){this.tableData=this.tableDataService.processDataForTable(this.apiData)}getBadge(e){switch(e){case"Aceptable":return"success";case"Inactivo":return"secondary";case"Precaucion":return"warning";case"Alerta":return"danger";default:return"primary"}}toggleDetails(e){this.details_visible[e]=!this.details_visible[e]}};d.\u0275fac=function(t){return new(t||d)(y(C))},d.\u0275cmp=S({type:d,selectors:[["app-smart-tables-basic-example"]],inputs:{apiData:"apiData",isLoading:"isLoading"},features:[P],decls:2,vars:2,consts:[["class","text-center p-4",4,"ngIf"],["clickableRows","","footer","","header","","pagination","",3,"activePage","columnSorter","columns","columnFilter","itemsPerPageSelect","itemsPerPage","items","sorterValue","tableFilter","tableProps","tableBodyProps",4,"ngIf"],[1,"text-center","p-4"],[1,"fa","fa-spinner","fa-spin"],["clickableRows","","footer","","header","","pagination","",3,"activePage","columnSorter","columns","columnFilter","itemsPerPageSelect","itemsPerPage","items","sorterValue","tableFilter","tableProps","tableBodyProps"],["cTemplateId","tableData"]],template:function(t,r){t&1&&D(0,N,3,0,"div",0)(1,Z,2,14,"c-smart-table",1),t&2&&(f("ngIf",r.isLoading),x(),f("ngIf",!r.isLoading))},dependencies:[z,E,B],encapsulation:2});var F=d;export{F as a};
